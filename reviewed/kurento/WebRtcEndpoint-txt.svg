<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1660px" height="1271px" viewBox="-0.5 -0.5 1660 1271" content="&lt;mxfile modified=&quot;2019-05-28T01:27:30.414Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/73.0.3683.86 Chrome/73.0.3683.86 Safari/537.36&quot; etag=&quot;Q3vzAQOdKcLLkd8K6HHu&quot; version=&quot;10.6.9&quot; type=&quot;github&quot;&gt;&lt;diagram id=&quot;tl3qFknxXSzmVGOha0O7&quot; name=&quot;kms&quot;&gt;5V1Zc9tGEv41qEoepMKNwSNAkbZjKytbztq7LymKhCSuKIImKVvKr985egZz4aBEkJRd5UooHANMT3dP99cHnGBw//hmNV7enpfTYu747vTRCc4c3/f8MMH/I0ee2JHID9mBm9VsChdVBy5n/xRw0IWjD7NpsVYu3JTlfDNbqgcn5WJRTDbKsfFqVf5QL7su5+pTl+ObwjhwORnPzaNfZtPNLTuKIrc6/raY3dzyJ3sunLkf84vhwPp2PC1/SIeCoRMMVmW5Yb/uHwfFnBCP04XdN6o5K15sVSw2XW7498c339Y3J39++fQ2Tv+5jN1h4J7AKN/H8weYsOPHczxevl6OF/j3Dfn9eTVerJflasNPXq34KWcYOenIyTNnmDi55+T4CP5z4KCBM0ROHpKz7EcWOMPYyWMHIfIDeU42InelmYNCciQNyVk8IBo5qfcb+ZWdOWlCLsoGTobP4SvwWD65OnPJY/A15GGj3y2vBkcwSeTJwGpsnvgSr8qHxbQgVPLw6R+3s01xuRxPyNkfmKnxsdvN/RxOm1TnJCxWm+JROgSr8KYo74vN6glfws9GEbsFRAIBg/yo+MvnXHQr8VYMx8bA0jdi5GrV8Q9Y+C2YwO/EBIP5jMzZygF4LfEqkh9nZPHwemdD8o8s/BlZO7Le+Idfv0rT2XdlWeJvD0QyckzUzcl4PrtZOEGGr5gX15vqrD6KstDbcJszTB0UkLclPDZ00jP68pi5Gdfhu4aGGBicJQ7T2bSwoeWNe6PFulhMPxXfHoo1vsGl00eUIPL0XUIlIsa5k6b0VERJFNIj8d39WiKgEPLEQamTp1Qkhw6ibJCF9Bp8MR4zFo/DXMgeri8LfYs8eZ10/bPczK5nk/FmVi5slJUISqSCKi88+5zptVzhy1dHgH8tzov1Gu+Cn4pJMfuO1WhFAVnG8HytKy/4yWCaV0cKOgc8MbrAKVYhA5UWA6ICCS0yJ/OktReSRDkmyySFKihoEM7PbXJGh0pzkOaUbsp4/80irsNykOY8lp4rLsaLNHJQcjteTOfFakdrsmdCNwiZSmgims0bRMKZ1wXxzRmVI0LilO1uLtk1wFBBsGWQh8ZkByF0Fw81pQGPEwBP4LXBZ/HtKOEcgLkE9SUWB7aAuMUDBpAwkSULKIgsFpDn92UChZ1MIC4YVhtIl0XKfMBSITGN92j6LFflBKvl336XBIOazpjy7Acw2YieSgnbgXKKKNea27y4Paa2uCfdTjUKucskAj1CVIt4KH0ZJiGYJsg/hE5hssjUMp4b8mpslhjsmjxw0kjRDfgIk05ER5BVC9ZGGQJjmcw2rhnfIESlcvhoPdOA2G1DRR+RN0olfSRrQ40YQsE1aKidv/W62FysigvG3ZTYPqYTOVquN9JhPJvck3gfkYmiiOtVWZnHdC/wpX0xJvNj1grxWYbiOXcPROeVtisEoeocntehmD0XKZo5tGhmP40smjnoSzPHhmb2DDJhIzwjWA/+q1wWC5Us+CTASp5PWGgzXm341dPZ+L5cTD/fzhb8FL825AdGs7kYanpTXMJjsRt4W96Ui/F8WB3NgYPPKPsGOaE89gzmGRy+Kjeb8p6M9DjbfMUH3NMI/voP+Qt+nz3KfzzBH7Xruy4fVpOi3cHHs7kpNu1oEJlmF245cU9RGAYKx5x4wB2rYo49ou/qmtm4A4a/KGcEXeBjCwQExvVSjcHYpOEuGfbSBgriloEYVRoG4heW19dY0xgMLejyfB5Pfkoe759fw635NXEDlV93xa6pymWRbql2ZdcwahnoCNgVdTKWBVo2Gk82JSGebv9OVsV4U/y9EbAaM5UzJFkXzErKKYpyJsEpzCIdEBSY7e7YlSJ2LIUg2cVkX5Z8XLKFI8nIYQYtNXqJ3TKQNnFzZBPZpFZTSi1/YjdkjQNSnxC88DP68hwsN4gijAxmW0YATIIvOKR+JzbWh9T+YE59bBr3P4qrdTm5KzYqwqLe/moQ8zDRhMKzmCVWh9HryyxJO8nAl+Lqki5DQwRlqwWvZ1F/IIViALDGXDApCRP4OQeMNA4YgB/AHDsCUXHJSAUK4Sk8BA4ic/6CfTq1wrkC2Ie8D33zjPouiAp9ZZszSTjjPl7aqB50af6xtkB2rxCRpGzCcEAyL+rJkcmENjwAcegsJX4TsoKGEidYQDDNxRUXp+RigM5cQurjABIBJrl8uFpPVrMlBfB9V/h74FCWK8W/a6dRDS4LUGvA2RQBOqQvDEVh01RamCMl3xYbSJ9ARki2c5Rz6gy7gcGMyvRifIuCeTHJSMEKyUcAf2QJB9izPid0QlnQeD0/Ht+TnXVxtSb/Iz7AWwFHKqf6fzkTNqdCAFolI9KjvRNIGsSK9vGGZMHOeHpAB4JO5uW6eKsCvH0KklVoepCOlO5irgRFCvQyJtyORirIO4BIEF7V9EyoQpu8yFJWhxtKqSCI7RKIqDYIODPQWYwshUrAJBHIsvli4hGmAmWRlqFiL7QybDXT7XmHsJzlkHHfiTmRE4gZAaycERXmu4Gi/Kstg9kxJr1ZqD6gxAiMHBx1dNlPIdAnUmBe/CzASWNyI1ycq6ZSSm9nbxjytY3srwoxAiRlVwyk2Gaqbo4aR5hIrjWKEZHfZAGH9FVlG2VA7eGYMB2Jmv48cm2GQMV6CNKYUiNWSHCMFMsAr9UksTBxhEMga4wRPcJENZTYSzxdyg/C6w37qU9FTGZTFwIlIm2iMrm0QIl5l/Qs4g4lTVHWV4XIh6Hq+ia2WCmyuL79pYtxn7rF962s58MEPpmzm3H7MG1AS2ySItxHk/12m7OyeyLcFcUym8++F5eYFNinwdRgXg3J7gggMp0HR/K262Iz/I4FRPbCwA6DF6c6hhkjIs3C4oUxPSR2eDVynfkiEeu+mM7Gl8Xzsvh24Kyw/TSlCKdvU9tddr2UzkWQImx0URscUnMbkULWYD2ZA8rJMV4V30cckiRIipTLogti7ftwXpB2EYbeJLA/pZ6NhDB1ngPO0No8qMyPPbM0vAidisrKXeADdW/dlu+PQ6hXxc1svSlWFhK8ZFaHRRqsCJs1sFDnq5gq2KXYbDfOOHjq13WJ1TTc6+7AuEm1RLDYT04j07yxIvth1Jd5Y9ZEDB83xWK6borJXs3LyZ2jRGJj9ifEVt2OpmFrcDTtGBxFHYOjEqU9bjO+MBoa6euKnhkNTTTr19fjOTXR0F1FOj2zNOKoeMELOjIDp9shuCHRonf+c2PjadAyUN/cEHRyfC6LFVaB58XmtiR8Ys0V1QwiMzvczFCUUY2gcsuZqVXjIf9vXS5Wy4l/yjaYRIoDZ2pUT41uW16aFVwhaQ+zZXs2xOcourbkOXrcvdpz/FDPWE0pGulyuCC24WVyXICFAyBN4TfqUmRwKGNGKY8/+jkgicR2lUJDaMTB0xHPrCTX/34Ig8aawounnFVztPu/xMAJOEqoATKx6iHojgp+3d6BMXuWhBTOE869lhwhy6TsT3mVI5n3GvyZFsQHvip4EGNUJcFkFKPOMp6sesaXIKLSmNASS1d57wrro3qigqRTxdtsH9OEcaX4JVlWhud79PaAVZKBGhwvxjekliTg9WUUiE9jDkEm0oPl1Wh7px4XAe93xXjN1oBh0gKuHtoUhOywpbTetYFezHvNTO/VRko5JmGWDw15bobItWcOCCKCquQr9ECia8CUwIeLiGYg6sKsnjSCE2ao5GFhdyL5QzDHZC5oa4BK2h9yDP7hmoFaINCdfLx62nTIJVGfx7B0uXzMeIPjINNs8b28Y+8spQAK4AdUM50OYFUsx0cLBAQtt2vyocS9tIvNggc5lDmkekuQ1yzkYlBjUMFqx0FnjpCB6HbPjWiYPKOUkZsmASDYqK4qE4X675KkYUQEj4SMNHG10k1KGmi3/RT0uqHyj2OCy9nihmd6RFQ/saWMpLzSxoQAYkTSNcbbQ0ZJQEynY0lcorkeEBzhq8h2j5SYrdmZDcRrgMzp7LJYthsEhm8aEGLxreHZpCZqb9VeOXhkYu+r9JmZ02mbT1ofSQZ9RsMBlhplc14NySMNM5Urp9qmfBzcQ/PVxxORLWia1GITgjxcm68c87YJjBKjpkDjUaDf8H6hFFqX106QIAM1X7t/ylZcZrdcFWjC0K/AVCYHCh/DDKrYgmIkPqXlv5oLwBZSkizCwCEvKZRUGwAsniosSgcN20NpwgKLH+QsviUCXax4lm2VGaU8TeYiDjebaUt14c+a8Vkf9+fyqNqC3c3nP9bl4tNyQp4eZCIZ0G2qdm1OT0HUHeF6QDRWqKk/TjOJDRLKTmf3FEdUmAp2loTq9tyGtjV0MYhp5Enk8riqGCrvwB+tNs2RX/s40n1lw7NV7DvVVu89a39fWWNMUSPJMLBtu7W7tloHoiQcyuZ8qPpb4ogtLRQ2joRIDkRPc7qqZkaHDA9pqIMJZArpYJUhmSTD+1CeAiyECbmccVFjslGDNURXTOkOk5L/Mm8T22gi6xMAqIjXIjA01CzqEUiUWDpzQHPFGpZXxbiqOqS4RuF19vrkzGB8AaLj0C4UNxNbcYWcY8pzg8FJ3RG7v6ocwlgrTg3NFMLQs8TYQz2+trsYu9lv5deueO4a1OchyG1K9JGr9hvcVYk+0sKxQfjcuG7aMlBNXBev9/hJumxJLlg3vHCqEiKJlI6Z+Acbsc+C6hP/03jwMbhPv78vllfX39azybpjF049b1GNzjZkCmJVxiw/xFOsoRpZRGBENfIAgsFpBCA7ajBR+gjRsk6f1ix0FsaSgypmoiTr5uLyCEFO9geK6YD3xBLA2+BY+Rj3QVEMuV6wvWppj9J+FBPEC8nxO9PmPGzOmonB0gTZjDNSTo3qLOT+dg44HzQwo45uJvXOZGXEWzghwgyVawSs5fSaq6xV0VOXK3OPj8Ks0oE7IAz1q8IQEeVeg4zMxMs5NXINd0O0cRE4tVdluaaZruS8z5FWCsKSaHUMC6KYgGYVuWkJ77UHl8Ywgk9UrmCSB6Xb5oRtvRWq0jAjO0NjmGql9AUiokyx4JRVMkes8KtHisi6L5NS1zvqvrpKYldPYdASH6DTYCyBZ3UpxT9B1VTrbMk1A8hhwSyTcRxPKPJ+y3+7sTjn45rSXwUao4rCDJDK6pkw0JdydVesLspyLs7RW7tvlcsjUb/WTV92E9WMJOsOr7btVDxXxjFiQ0wPoj23ygSikSIBLWfci7e0js0KKWHf1v2xoWJKrk/Vmj6a79Ywsnlxw8jG1HreswB+qH++pQjWnKJ5l45LkJi5jEy0tZjoG8sy19oI9cJsaXIGgbmAo9Yszvpu8de6aCk1h2BjA+FoFipKYGfOK2gIDG8XYk7QltEMzZkDCFiwQ6rXHpIxM5WUmjGuq/H3RbEcfyA+vF49f6bWXKsayyTDnvlHsHaD1upc5i547Hy8FEOvsCZbiSg/OdO3PtZCmAJeFfVq1BzNEimEIXapBmAdpji5nc2nq+IQMzEbUzV0F4iglb+8xBbS1M+/86KXV/8rJpt13wTZs4VqwjWmhSq4Xs6w/TUDWpRKuRwWBN6s0DLXZi2JlkrWxlhZlaKhZNGo6eL26IWp7ERagpngK+Xdk9zGzHZNl1SZvXSMltObB5BDQXb/XA30RJSc0o5rpi5XbcFaeb1TsO7YIi6ep1XAic71cszFVtcoejm8JOZiBZnNUjbJ47NAyg3gCcT3PM2OV4pjpDQhOcFgyE0UxFO8rHas/CL6yAz6oikas/JvogRneCU7QWGamGifseK1S2qIEfQA2bcBRmEetYRqgt1qc2X0Jnky7mR4+Tp1zFQHSbno/rytskN7+narLIupViQlQdyQHyp0g/z9GwWxNOkjr56cYFODVlp2lkOLeaJXJCammAeBRcx7k3KzRPGXCaw2hdbkwGqTduwcV/XUiOVOAqpepDV/DvRy564RVS/xWkbaXamslZxmfF8pB3t3v6zZc9SiJvrJMdOAaOiQoaOaqtbJ4ONIrWaH5d12BKZb3hm2HmGxVgPX7lfFTQVGmxYnq6PR7Ujq6ltTvo5Qs8ZxeqpG68PA1K2iAnwvuvUXbtP/It26bZv+XnRr7KsaMdL7o3XXrahlpB2lq2AZ0PK2Yrf5zVpuUBNcdqXqza8BnBNF9i+KztQo+h4LCWeb2Xj+bmrHfqvPARlgu2yYIwjLV/XuDLd7yVcadz/Xxfi+4Bk7WvKrWc8o56TzayCftOFi65eUNNL9Td0BBEgh2VmT0yqjaMi7ch4oSNb1gwl3xdMJY2FLPfZegixytEczWERff7ZmA+BNKL5zFd4k1wS8/yYLFgtDwUyykdo0ABILYBURCfjJ+Mw+9QObCb6rfSZIWNCykWBrj6l/BWhnRoL5YYhDdQxq2otb9+wDdo/y9D4/YlG33ap9V/8sjz5Sz26QpVWqtDnavAwTc94q0m98jH2vyZt65gxvEpQlYmtQXpH4Ua4UVhJpGEJjmeFaqY+IuukoOLtcfQ+N9/g3FhmodxxbuG2CDFzNpUac1nJSHxpkV0Vcyn62Gd+om35dL86GbK+DU0ZbXznCPVK/2Wju9DI8m9CaScoVaGQjgsjJNOtdxAJREwgwWB7r0N9QfPOVVXUei6XYSSKUEp8zQDowdzELmFVnMWBBdMqyntUbGlibJJh2h0AnTGPnhSx6aBtF/wIh98paQWLP7ctIsfS47GKeTMfrW0E51TjRoI2d2Cqoo61yyOaGeOk0EyN5rrES6MaKPlLfxooZIfyMd5E9l3/URuMbPDaeNHIs2tbWVk98brjm48KkVaMtV0Z0+Qj5h0oaPjH8GtRholVhWb8x7Fu+MbyLDxrYGd8MmpFcxXZoV1N6inrciQbkmq1dBXaNX/WhAvVgU6zvW51VIEpaRupbBZpxq0/QyfyCLZ/dZVNqzhp0VqMl3lBBJQoQovrPLh5YrgNP2whD20c6bWXG/cl1ZKzmUWExXGjbpbtrBKUH6Q5czXyNnlvmG/h6CKZjne8zpPtq4g4+zbNP6z/i8O2Huw/pn8PQUmZLwZiL2bKYzxaFTbbNtBZbTjr0P+PCWYHfsktV9zEaE9+xhW6VTxPK2HDC+0gxl9Pbr71m1gGIj6aJTsIRd9KF02dUyB6L4aZ3N7xhNZbEAtu29+ChzaxQ25RtH44SqnfX6tgqfqaVdSht3KQdjtvb1KPYid6io7OppUexjZF2p4yfni4uovDDh6flpxP3fPHmzfKPS4syvrSls1tSNGUE3Yp8A6ws9bfRW16Bm3V336W7ldZnQasGtDVErUkb/41cnaYAbKOc51LH/CNNLB2ooURKnNK3iN/VPaL14zmH1k563C609KTpTTtZ+dEEPw6lnZrE5bi1k6/nLz73uy/G7mWM1LN2Op69qmsUt4lrDhLFRfGumMH198YMD4/l5yLbzK6Ci/Prd+8f33389tWiGthW9W5xXdo2CdbzgzUBZq10EqK9kVuTzrqV5u4Te0UpfCQZAi9SrFUEo/Vvz9SHYY/FqDfxGTEL6LFpSVdSzAJtvaxkieBLHfo3N16T0+DFqZ51G1sSary0p43ZKn2mKj4vpw/zYmvps/Fql8TvRrnQB2SVOnLRX4fgp9XWrXp0DWmUlY98fNacF2mRK2TxNffLNHX1B5+fllacR7fr359fisjM+8ElR3vCJpVxhAuD/GNbGDNbWFH9jHBMwCtP0NrjpmEDkeJwSgnam/nsSmh29hBeaB5IJWimS1dbgr3FyzSoEaE0KHMR3SV/LWkE3eHxKyin2Ge4eAdq6B+WVLm9aZfOTfUb57wcY14djSebcjUr1vbCFUu0MgS8tKph3CZ5Y6u68baXZ0tsffVnbQWvazMPNeG3beV+X8WJVuE3c2N/hgIavESrp6/EvTtFsccP/AcfOHFPXTflR84eHZ4rQ/56kv+6KFYzTGOs7djBnbqGTU7NFo1kExQghaHC3TiK+vdBn51BYyYOd8yg2boyJ4lD9UGopTIHxUHTDc4+Ws9a2cCSofyzyaSb6DKJ+bgvmWyStVaZ3LZQrj+ZTL3wFPlJhGLfjVEaJ+pOEqenSRp4bhCG9Krnymvin9Lho8hL/NBThSrBziiMT94i1WZRI8tdhGdreddbXSdx1DazoOmGF1fi2WXZjKn8DLLcv9xt31S9L7lDbmiTrJdG+7wUBaehF4ihVUnDTzol8ifO70zSdsbaJgb7y7D2i8y8rnVcr5e14zQ6lTjbV8cVmvsQ20aiJzy1FXBHXtR0w4u3jVH+8errX39Phl/ejt59O/ln/efTHx2/PqCkSu27rFvvCZplkJljflhTRySol8/6HUMPzZ18c7Pm4n6yyaEzlVrRznKs9CIeufe5mYPGSvHMeju9m9QNNLiqa8lktCM/lliPmWsmyqobc7uUrr0io00ju2jE19BR/9g+RCDSA0WhuFQNXn23Sfu8YEMCs55MUyOIakuc57PKgUE039VSGpKuiSq7ANGs6tq0hA6VmtC0mxxzgbkfhejU87WPAemGQuf0hCgwR+uxdstK9ePJV+nKFE05mAcq5AuI7Vv9U9njue2CsBUYngZ+KP4pw8b9NST4J/2wHr35+N/461f36uvjuwh51xZbb/+VTo0fNmtPcDsci3i+3m3kuSlNnl4TbIzUMx/8wu60lf0s7vRuvr/XRy+zQK+3e26byFAvt9tZl0j856ok5ml1OTbPbs/LaUGu+D8=&lt;/diagram&gt;&lt;diagram id=&quot;yhOdGlBhut4Abr9xinY_&quot; name=&quot;WebRtcEndpoint&quot;&gt;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&lt;/diagram&gt;&lt;diagram id=&quot;Ylm0gqa067iATK1IETS1&quot; name=&quot;show something&quot;&gt;3Zrfc6I6FMf/mjy2QxLCj0dR3D7cO3fv+rDtvlGIQi8SBmPV/etvkKBCUqetgmxnnJEcfmg+35NzThIAHi+334ogj/9mEU0BMqItwBOAEESmLb5Ky66yEAtXhkWRRJXJOBpmyW8q76yt6ySiK2mrTJyxlCd50xiyLKMhb9iComCb5mVzlkYNQx4sqGKYhUGqWn8mEY8rq0OMo/2BJou4/mVoyDPLoL5YGlZxELHNiQn7AI8Lxnh1tNyOaVrCq7k8+O48f7TZLFo9zWb/BvFmy+6qh00/csuhCwXN+Kcf/ev7j/D3P+jhefaw5VmQTV/uaP3o1yBdS17AJ8CxgEOAbwNvAkY+8EVzClxxygSeBzxL8uC7GnLB1llEyx8yAPY2ccLpLA/C8uxGuJWwxXyZihYUh0GaLDJxXFTUvVda8EQINpL2Z8Y5W4oT7+x23QfxGLo9EV1i+EbZkvJiJy6RZ+1aUenSwlK1N0cHQVi6eXziHAhKYyCdcnF49hG8OJDs9To8pePJ+A4GaZ5Hq0fi5atwfodUIV5WLCvysKTvEuAZexn2elxEf56k6ZilrNjfi6dTn7juiSopnfMO2WPYZG8hrLK3kMreNDpCrxsCbYdHf7jHQ7NJHduGQp3UIfGUut0VdUOh/t+67DX7YqShSfojre2C/Q7/hl+MOrJU6tjs07+hqSClkShMZDNjmfjympRZwWO2YFmQ/sVYLtm+UM53sqwK1mJ8NMgLjsXusbz/3iZ1+0k+b9+YbButnWx9TIkVWxchPXOdDOI8KBaUn8EiqZQozupa0DTgyWuzhtOJJG/9zhLRj4M/mK0so2SPqkPyrpbUh7/xefXdfsTfJvzx5Hiv+z2RraPwZaMj3ZGq+zn/uJ7uF4VEpA+JPhiRfflL5IEHgXNh6u8s4lmtPGOpGR0iTcTrro4yFFJf1Ok1wU573dWD3WX6qEm+S32Me0ROJIJnBRpwGtNeR4alrBqjulD2RqytW7HWLpiQngeR/ZlB1BhBchzedBBpURqDqgmwpiYQsyMHuKN9TTACIzjwmgCjG9YE5zJgq9BqLWcNG6rpDA0qUaDSlC5Fty+cxfdVqiLn1gSttwgO1AfbA7tXgvr16rcI4mESbPsgdtQFon4JqvlGElQXjgZBsO2DtyeoJhdJUK3RBkGwnUluTxCqqeTam32t7SbXnU73202dDfTWSjAhzq0hq9nmKlsdb23k9UVWt3PXM1lX674d7pZ27r6m6XzOfRHpKtOrO3V/PmS36ckY3r8zFKMrvABwbjJ8Qvknff7BQz+Lcrm3IbPbZaxvvlVn1y9b1LUsNhX0CNoqeljPEK/OXi1mQ4C8/ceQc393CnwHOLh8I6Z8L8YDjlmecg3gOAOfwdo14QNxVyVuwG4Ctxa4WvuGb6C2wMiRCy/uBLj24FGTJmrX1kQWZKAeYatl8mJ1YRDpDl8zNmCimee6jgbex0ODaB5f3av2fY8vQGL/fw==&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><g transform="translate(1.5,6.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="807" height="776" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 807px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">基本概念和规则说明：<br />目标 - 建立一个webrtc连接。端到端的协商机制使用sdp的请求/应答模型，而且两端都需要支持。<br />kms作为p2p的一端，如果kms是sdp协商发起端，那协商过程的初始化由kms完成；如果kms是sdp的处理端，那协商过程的初始化由远端完成。<br />kms生成sdp offer-发送sdp offer给远端-远端处理sdp offer，生成sdp answer-发送sdp answer给kms-kms处理sdp answer<br />kms接受sdp offer，处理并产生sdp answer-发送sdp answer给远端-远端处理sdp answer<br />需要注意的是：kms处于不同角色的时候调用的api是不一样的。<br /><br />sdp和ice不是同时发送的，这里使用了ice发送策略优化，等sdp处理完了，两端都需要开始收集ice候选，目标是创建一个全双工的媒体通道。这个时期，两端都会做以下几件事：<br />- 收集自己的ice候选(ip+port，ice候选并仅仅是ip和端口，还包含传输方式、认证信息等)<br />- 将自己的ice候选发送给远端，让远端去做探测<br />- 收到远端来的ice候选之后，会立马拿去做测试<br /><br />ice发送策略优化是指ice的产生是异步的，目的是提高速度。<br /><br />异步会要求：收集ice候选之前需要先监听ice捕获事件，不然会丢ice候选;业务需要基于异步来设计(eg:开始录制要在有流之后才有意义)<br /><br />事件订阅正好适合异步场景<br />WebRtcEndpoint支持以下事件：<br />- <span>IceComponentStateChange：ice状态改变时触发(初始化、收集本地ice、连接中、有一对已连接、结束、失败-匹配已结束但通道未建立)<br /></span>- <span>IceCandidateFound：发现一个本地ice，所有本地的ice都需要走这个事件，不然可能会导致整个协商失败<br /></span>- <span>IceGatheringDone：所有本地ice被找到<br /></span>- <span>NewCandidatePairSelected：一个更高权重的匹配对被找到，在媒体会话过程中也可能触发这个事件，前提是权重更高的匹配对被找到。<br /></span>- D<span>ataChannelOpen：数据通道被打开<br /></span>- D<span>ataChannelClose：数据通道被关闭<br /></span><br />流控和拥塞控制是webrtc的一大特征<br />webrtc连接开始时，会用配置中最小的带宽，然后慢慢增加到最大允许的带宽，如果没有限制带宽，webrtc会增加到能检查的极限。这时webrtc的自适应。<br />WebRtcEndPoint设计的是这样的：一个流的多个拉取端的流质量是一样的。意味着如果一个新的拉取端加进来，会导致所有拉取端的质量有一个短期下降，直到稳定。并不是说稳定后比稳定前的质量差，webrtc会自适应。上面说到的并不适用于转过码的流。WebRTCEndPoint拉原始流和拉转码后的流，她们的质量是不一样的。<br /><br />默认的带宽是100kbps-500kbps，可在输入或输出方进行修改。<br />- 输入带宽控制机制：告诉远端：我们(WebRtcEndpoint)支持的码率范围是多少。<span>setMin/MaxVideoRecvBandwidth，</span><span>setMin/MaxAudioRecvBandwidth</span>。最大值写在SDP中，最小值用于限制REMB包的最小值(remb是google出的一个拥塞控制算法)，换句话说就是，对端要支持remb，最小值才有作用，目前chrome是支持remb的。<br />- 输出带宽控制机制：控制我们(WebRtcEndpoint)能输出码率。虽说我们能控制输出的码率，输入的码率依然受网络和远端的能力的影响，远端可以通过sdp中的b=xxx来设置码率的限制 <span>setMin/MaxVideoSendBandwidth<br /></span><br />带宽控制必须在sdp协商之前指定，sdp协商之后是无法修改的。<br /><br />数据通道：可以让其他媒体元素传输任意数据。WebRtcEndpoint并没有为这个功能暴露API，只能通过配置达到以下效果：<br />- 可靠(部分可靠)地发送消息<br />- 有序/无序 地发送消息<br />不可靠，无序类似于udp机制，如果通道配置成部分可靠，需要指定重试次数或重试时长，webrtc栈会处理应答和超时。<br /><br />如果要启动数据通道，需要在WebRtcEndpoint创建时显式指定，默认情况下这个特征是不启动的，<span>createDataChannel函数就是启动数据通道。这个函数有很多可选参数，下面几个是必选参数：<br /></span>- label：标签，用于区分不同的通道<br />- ordered：设置默认模式，如果<span>maxPacketLifetime 和 maxRetransmits参数未指定，表示启用可靠模式，不然就是部分可靠模式<br /></span>- <span>maxPacketLifeTime：单位ms，重传最大时长<br /></span>- <span>maxRetransmits：最大重传次数<br /></span>- <span>Protocol：数据交互的子协议名</span><br /></div></div></foreignObject><text x="404" y="394" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(840.5,6.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="363" height="819" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 364px; white-space: nowrap; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div>idl暴露的接口</div><div><br /></div><div>// ice候选</div><div>struct IceCandidate{</div><div>    std::string candidate;        // 协议规定部分</div><div>    std::string sdpMid;            // 媒体流标识</div><div>    int sdpMLineIndex;            // sdp中定义的流索引</div><div>};</div><div><br /></div><div>// ice匹配对，用于具体某路流，被ice库调用</div><div>struct IceCandidatePair {</div><div>    std::string streamID;          // ice匹配的一个流id</div><div>    int componentID;             // ice匹配的组id</div><div>    std::string localCandidate; // 本地ice</div><div>    std::string remoteCandidate;// 远端ice</div><div>};</div><div><br /></div><div>// ice匹配的状态</div><div>enum IceComponentState{</div><div>    DISCONNECTED     // 未连接 初始化状态</div><div>    GATHERING         // 开始收集本地ice候选</div><div>    CONNECTING        // 已组成一个匹配对，开始进行测试</div><div>    CONNECTED        // 已有一个匹配对通过连接测试</div><div>    READY            // 所有匹配对已测试完成</div><div>    FAILED            // 所有匹配对已测试完成，所有测试都失败</div><div>};</div><div><br /></div><div>// 某路流的某组匹配对的匹配状态</div><div>struct IceConnection {</div><div>    std::string streamId;</div><div>    int componentID;</div><div>    IceComponentState state;</div><div>};</div><div><br /></div><div>class WebRtcEndpoint {</div><div>private:</div><div>    std::string stunServerAddress; // stun ip</div><div>    int stunServerAddress; // stun port</div><div>    std::string turnUrl; // turn url</div><div>    std::vector&lt;IceConnection&gt; IceConnectionState; // 匹配信息</div><div>    std::vector&lt;IceCandidatePair&gt; ICECandidatePairs; // 协商的匹配对</div><span><br /></span><div>public:</div><div>    WebRtcEndpoint(MediaPipeline mediaPipeline,</div><div>                    bool recvonly = true,</div><div>                    bool sendonly = false,</div><div>                    bool useDataChannels = false,</div><div>                    CertificateKeyType certificateKeyType = "RSA");</div><div>    gatherCandidates();</div><div>    addIceCandidate(IceCandidate candidate);</div><div>    int createDataChannel(std::string label = "",</div><div>                    bool ordered = true,</div><div>                    int maxPacketLifeTime = -1,</div><div>                    int maxRetransmits = -1,</div><div>                    std::string protocol = "");</div><div>    closeDataChannel(int channelId);</div><div>};</div></div></div></foreignObject><text x="182" y="416" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1474 120 L 1474 153.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 158.88 L 1470.5 151.88 L 1474 153.63 L 1477.5 151.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1309" y="20" width="330" height="100" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1310.5,27.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="326" height="84" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 326px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">main.loadModule()<br /><div style="text-align: left"><span>在程序启动的时候会去加载插件，加载时用的到技术和windows上动态库查找符号是一样的，找到函数符号后，只做了一件事：将媒体元素的创建方法读出来，接下来的事交给信令。下面只讨论WebRtcEndpoint这一种媒体元素(</span><span>WebRtcEndpointImplFactory创建的</span><span>)。</span></div></div></div></foreignObject><text x="163" y="48" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1474 210 L 1474 243.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 248.88 L 1470.5 241.88 L 1474 243.63 L 1477.5 241.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1364" y="160" width="220" height="50" rx="7.5" ry="7.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1381.5,171.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="184" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 185px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>WebRtcEndpointImplFactory<br />提供了WebRtcEndpoint对象的创建<br /></span></div></div></foreignObject><text x="92" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;span&gt;WebRtcEndpointImplFactory&lt;br&gt;提供了WebRtcEndpoint对象的创建&lt;br&gt;&lt;/span&gt;</text></switch></g><path d="M 1474 480 L 1474 500 L 1474 490 L 1474 503.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 508.38 L 1470.5 501.38 L 1474 503.13 L 1477.5 501.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1289" y="250" width="370" height="230" rx="34.5" ry="34.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1290.5,257.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="366" height="214" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 366px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>WebRtcEndpointImpl<br />WebRtcEndpoint的一个实现，</span><span>事件：ice的相关事件</span><span><br /><div style="text-align: left">属性的读写(stun turn ice匹配对信息 ice匹配结果)</div><div style="text-align: left">收集本地ice候选 和下面添加ice都是通过gobject信号来触发的</div><div style="text-align: left">获取远端ice候选</div><div style="text-align: left">数据通道的操作(数据通道是webrtc的一大特色，kurento虽然提供了api，我们都没有使用到，接下来和数据通道的相关信息不会提到)</div><div style="text-align: left">postConstructor 注册信号，也就是订阅事件的处理<br /></div><div style="text-align: left">fillStatsReport<br /></div><div style="text-align: left">接下来还包含了各个事件的回调 通过信号和槽发送出去, 如果调用这个类的connect方法，可以指定槽函数</div><div style="text-align: left">在这个类的实现中就包含了大量的gobject和gst的使用</div><div style="text-align: left"><br /></div><div style="text-align: left">构造函数中：检查h264的支持</div><div style="text-align: left"><br /></div></span></div></div></foreignObject><text x="183" y="113" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1474 599.5 L 1474 620 L 1474 609 L 1474 622.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 627.88 L 1470.5 620.88 L 1474 622.63 L 1477.5 620.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1289" y="509.5" width="370" height="90" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1291.5,512.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="364" height="84" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 364px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>BaseRtpEndpointImpl<br />添加了流控和拥塞机制，事件：媒体流状态、连接状态<br /><div style="text-align: left"><span>带宽控制更多的是针对视频来说的：最小入口带宽、最小/大出口带宽</span></div><div style="text-align: left"><span>媒体流状态：有媒体数据、没有媒体数据</span></div><div style="text-align: left"><span>连接状态：已连接、未连接</span></div><div style="text-align: left"><span>也会保存"延时检查"功能是否启用</span></div></span></div></div></foreignObject><text x="182" y="48" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1474 800 L 1474 873.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 878.88 L 1470.5 871.88 L 1474 873.63 L 1477.5 871.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1289" y="629" width="370" height="171" rx="25.65" ry="25.65" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1310.5,628.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="326" height="171" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 327px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>SdpEndpointImpl</span><span><br />添加了流控和sdp的处理<br /><div style="text-align: left"><span>带宽控制：视频最大入口带宽、音频最大入口带宽</span></div><div style="text-align: left"><span>媒体流状态：有媒体数据、没有媒体数据</span></div><div style="text-align: left"><span>连接状态：已连接、未连接</span></div><div style="text-align: left">生成sdp offer：利用glib发送信号给底层</div><div style="text-align: left">处理sdp offer：glib发送，然后利用信号通知槽函数</div><div style="text-align: left">处理sdp answer：glib发送，然后利用信号通知"媒体会话开始"</div><div style="text-align: left">这3个对一个媒体元素来说，只处理一次(媒体元素不能复用)</div><div style="text-align: left">获取本地sdp和远端sdp：利用glib发送信号</div><div style="text-align: left">在postConstructor中会订阅媒体会话创建事件，以获取sessId</div><div style="text-align: left"><br /></div></span></div></div></foreignObject><text x="163" y="92" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1474 950 L 1474 1023.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 1028.88 L 1470.5 1021.88 L 1474 1023.63 L 1477.5 1021.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1289" y="880" width="370" height="70" rx="10.5" ry="10.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1290.5,886.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="366" height="56" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 366px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>SessionEndpointImpl<br /></span>向外暴露了两个订阅事件：媒体会话开始、媒体会话结束<br /><div style="text-align: left"><span>因为没有像其他类在</span><span>postConstructor中通过glib订阅底层事件，所以上面两个事件虽然向外暴露了，但一直没有触发</span></div></div></div></foreignObject><text x="183" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1474 1070 L 1474 1090 L 1474 1080 L 1474 1093.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1474 1098.88 L 1470.5 1091.88 L 1474 1093.63 L 1477.5 1091.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1289" y="1030" width="370" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1411.5,1036.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 124px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>EndpointImpl<br />留了接口 为以后做扩展<br /></span></div></div></foreignObject><text x="62" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;span&gt;EndpointImpl&lt;br&gt;留了接口 为以后做扩展&lt;br&gt;&lt;/span&gt;</text></switch></g><rect x="1289" y="1100" width="370" height="170" rx="25.5" ry="25.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1290.5,1106.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="366" height="156" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 366px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>MediaElementImpl<br />表示的是一个媒体元素<br />维护了媒体元素的连接、断开、流状态、转码状态、设置流的格式、输出gst内部信息、判断是否有流、维护码率范围<br /><div style="text-align: left"><span>支持的事件：媒体输出状态变更、媒体输入状态变更、转码状态改变</span></div><div style="text-align: left"><span>构造：新建一个元素，添加到管道中</span></div><div style="text-align: left"><span>getStats：获取一些信息，延时 id 类型 时间戳</span></div><div style="text-align: left"><span>getSourceConnections：获取source的连接</span></div><div style="text-align: left"><span>getSinkConnections：获取sink的连接</span></div><div style="text-align: left"><span>connect/disconnect：和指定媒体元素连接起来</span></div><div style="text-align: left">通过glib收到事件后，会通过信号发送出去</div></span></div></div></foreignObject><text x="183" y="84" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(194.5,1089.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="238" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 239px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next:<br />kms-elements/src/gst-plugins/webrtcendpoint<br />基于gstreamer的功能实现<br /></div></div></foreignObject><text x="119" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next:&lt;br&gt;kms-elements/src/gst-plugins/webrtcendpoint&lt;br&gt;基于gstreamer的功能实现&lt;br&gt;</text></switch></g></g></svg>